<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Trabajadores</title>

  <!-- Estilos -->
  <link rel="stylesheet" href="css/style.css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto:700&display=swap" rel="stylesheet"/>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"/>
  <!--sweetAlert-->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
  <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-custom">
        <div class="container-fluid align-items-center justify-content-between position-relative">
            <!-- Lado izquierdo: Logo + Título -->
            <div class="d-flex align-items-center">
                <a class="navbar-brand mb-0" href="inicio.html">
                    <img src="img/logosindicato.png" alt="Logo Sindicato" width="130" height="120">
                </a>
                <span class="navbar-title text-white ms-3">
                    RepSindical HGZ NO.2
                </span>
            </div>

            <!-- Lado derecho: Usuario -->
            <div class="d-flex align-items-center text-white">
                <div class="dropdown">
                    <button class="btn btn-link text-white text-decoration-none dropdown-toggle d-flex align-items-center" 
                            type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <span class="me-2">Zumiko Danae Montalvo López</span>
                        <img src="img/perfil.jpg" alt="Perfil Admin" class="rounded-circle" width="50" height="50">
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#"><i class="bi bi-person-circle me-2"></i>Mi Perfil</a></li>
                        <li><a class="dropdown-item" href="#" onclick="confirmarCerrarSesion()"><i class="bi bi-box-arrow-right me-2"></i>Cerrar Sesión</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

  <!-- Contenedor principal -->
  <div class="d-flex">
    <!-- Menú lateral fijo con íconos y texto desplegable -->
    <nav id="menuLateral" class="menu-lateral">
      <ul>
        <li>
          <button id="toggleMenu" class="menu-toggle">
            <i class="bi bi-list"></i>
            <h3 class="menu-text">Menú</h3>
          </button>
        </li>
        <li><a href="inicio.html"><i class="bi bi-house"></i><span class="menu-text">Inicio</span></a></li>
        <li><a href="trabajadores.html"><i class="bi bi-people"></i><span class="menu-text">Trabajadores</span></a></li>
        <li><a href="configuracion.html"><i class="bi bi-gear"></i><span class="menu-text">Configuración</span></a></li>
        <li><a href="formatos.html"><i class="bi bi-file-earmark-text"></i><span class="menu-text">Formatos</span></a></li>
        <li><a href="registrar.html"><i class="bi bi-person-add"></i><span class="menu-text">Registrar</span></a></li>
        <li><a href="cerrar-sesion.html"><i class="bi bi-box-arrow-right"></i><span class="menu-text">Cerrar sesión</span></a></li>
      </ul>
    </nav>

    <!-- Contenido principal -->
    <div class="flex-grow-1 p-4">
      <!-- Breadcrumb -->
      <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="inicio.html" class="text-decoration-none">
              <i class="bi bi-house me-1"></i>Inicio
            </a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">
            <i class="bi bi-pe me-1"></i>Trabajadores
          </li>
        </ol>
      </nav>
        <!-- Encabezado con botón -->
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h2><i class="bi bi-people"></i> Trabajadores</h2>
          <a href="registrar.html" class="btn btn-success">
            <i class="bi bi-person-plus-fill me-1"></i> Agregar trabajador
          </a>
        </div>

        <!-- Buscador y filtro -->
        <div class="row mb-4 align-items-center">
          <!-- Buscador -->
          <div class="col-md-8">
            <input type="text" id="buscador" class="form-control" placeholder="Buscar por nombre, matrícula, departamento o correo...">
          </div>
          <!-- Filtro por departamento -->
          <div class="col-md-4 d-flex justify-content-end">
            <div class="input-group">
              <label class="input-group-text" for="filtroDepartamento"><i class="bi bi-funnel-fill"></i> Filtros</label>
              <select id="filtroDepartamento" class="form-select">
                <option value="">Todos</option>
                <option value="Administración">Administración</option>
                <option value="Recursos Humanos">Recursos Humanos</option>
                <option value="Mantenimiento">Mantenimiento</option>
                <option value="Enfermería">Enfermería</option>
              </select>
            </div>
          </div>
        </div>
        <div class="table-responsive col-md-15">
            <table class="table table-hover">
            <thead>
                <tr>
                <th scope="col">#</th>
                <th>Matrícula</th>
                <th>Nombre</th>
                <th>Departamento</th>
                <th>Teléfono</th>
                <th>Correo</th>
                <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                <td scope="row">1</td>
                <td>123456</td>
                <td>Juan Pérez</td>
                <td>Administración</td>
                <td>555-1234</td>
                <td>juan.perez@example.com</td>
                <td class="text-center">
                  <a href="#" class="text-primary me-3" data-bs-toggle="modal" data-bs-target="#editarModal" title="Editar">
                    <i class="bi bi-pencil-square fs-5"></i>
                  </a>
                  <a href="#" class="text-success me-3" title="Ver">
                    <i class="bi bi-eye-fill fs-5"></i>
                  </a>
                  <a href="#" class="text-danger" onclick="confirmarEliminacion('Juan Pérez')" title="Eliminar">
                    <i class="bi bi-trash-fill fs-5"></i>
                  </a>
                </td>
                </tr>

                <tr>
                <td scope="row">1</td>
                <td>098765</td>
                <td>Maria Pérez</td>
                <td>Mantenimiento</td>
                <td>1234567890</td>
                <td>maria.perez@example.com</td>
                <td class="text-center">
                    <a href="#" class="text-primary me-3" data-bs-toggle="modal" data-bs-target="#editarModal" title="Editar">
                      <i class="bi bi-pencil-square fs-5"></i>
                    </a>
                    <a href="#" class="text-success me-3" title="Ver">
                      <i class="bi bi-eye-fill fs-5"></i>
                    </a>
                    <a href="#" class="text-danger" onclick="confirmarEliminacion('Juan Pérez')" title="Eliminar">
                      <i class="bi bi-trash-fill fs-5"></i>
                    </a>
                </td>
                </tr>

                <tr>
                <td scope="row">1</td>
                <td>789012</td>
                <td>Ana Lopez</td>
                <td>Enfermería</td>
                <td>7711982189</td>
                <td>ana.lopez@example.com</td>
                <td class="text-center">
                  <a href="#" class="text-primary me-3" data-bs-toggle="modal" data-bs-target="#editarModal" title="Editar">
                    <i class="bi bi-pencil-square fs-5"></i>
                  </a>
                  <a href="#" class="text-success me-3" title="Ver">
                    <i class="bi bi-eye-fill fs-5"></i>
                  </a>
                  <a href="#" class="text-danger" onclick="confirmarEliminacion('Juan Pérez')" title="Eliminar">
                    <i class="bi bi-trash-fill fs-5"></i>
                  </a>
                </td>
                </tr>
                <!-- Más filas de trabajadores -->
            </tbody>
            </table>
            <!-- Modal Editar Trabajador -->
            <div class="modal fade" id="editarModal" tabindex="-1" aria-labelledby="editarModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="editarModalLabel">Editar trabajador</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                  </div>
                  <div class="modal-body">
                    <form id="formulario">
                      <div class="mb-3">
                        <label for="matricula" class="form-label">Matrícula</label>
                        <input type="text" class="form-control" id="matricula" value="123456">
                      </div>
                      <div class="mb-3">
                        <label for="nombre" class="form-label">Nombre</label>
                        <input type="text" class="form-control" id="nombre" value="Juan Pérez">
                      </div>
                      <div class="mb-3">
                        <label for="departamento" class="form-label">Departamento</label>
                        <input type="text" class="form-control" id="departamento" value="Administración">
                      </div>
                      <div class="mb-3">
                        <label for="telefono" class="form-label">Teléfono</label>
                        <input type="text" class="form-control" id="telefono" value="555-1234">
                      </div>
                      <div class="mb-3">
                        <label for="correo" class="form-label">Correo</label>
                        <input type="email" class="form-control" id="correo" value="juan.perez@example.com">
                      </div>
                      <button type="submit" class="btn btn-primary" id="btnGuardar">Guardar cambios</button>
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
        </div>
    </div> <!-- Fin contenido principal -->
  </div> <!-- Fin contenedor principal -->
  <!-- Bootstrap JS (necesario para que los modales funcionen) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const botonGuardar = document.getElementById("btnGuardar");
      const formulario = document.getElementById("formulario");
      const modalElement = document.getElementById("editarModal");
      const modal = bootstrap.Modal.getOrCreateInstance(modalElement);

      botonGuardar.addEventListener("click", function (e) {
        e.preventDefault();

        // Cierra el modal primero
        modal.hide();

        // Espera un poco para que se note que se cerró, luego lanza la alerta
        setTimeout(() => {
          Swal.fire({
            title: "¡Cambios guardados!",
            icon: "success",
            confirmButtonText: "OK"
          });
        }, 300);
      });
    });

    function confirmarEliminacion(nombreTrabajador) {
      Swal.fire({
        title: '¿Estás seguro?',
        text: `¿Deseas dar de baja al trabajador ${nombreTrabajador}?`,
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: 'Sí, dar de baja',
        cancelButtonText: 'Cancelar',
        reverseButtons: true
      }).then((result) => {
        if (result.isConfirmed) {
          // Aquí solo mostramos una alerta de éxito (no hace nada aún con la base de datos)
          Swal.fire(
            '¡Eliminado!',
            'El trabajador ha sido dado de baja visualmente.',
            'success'
          );
          
          // Aquí puedes ocultar la fila de la tabla o hacer otra acción visual
          // Por ejemplo:
          // document.getElementById('fila-123').style.display = 'none';
        } else if (result.dismiss === Swal.DismissReason.cancel) {
          Swal.fire(
            'Cancelado',
            'No se dio de baja al trabajador.',
            'info'
          );
        }
      });
    }

    document.addEventListener("DOMContentLoaded", function () {
      const buscador = document.getElementById("buscador");
      const filtroDepartamento = document.getElementById("filtroDepartamento");
      const filas = document.querySelectorAll("tbody tr");

      function filtrarTabla() {
        const texto = buscador.value.toLowerCase();
        const departamentoSeleccionado = filtroDepartamento.value.toLowerCase();

        filas.forEach(fila => {
          const matricula = fila.children[1].textContent.toLowerCase();
          const nombre = fila.children[2].textContent.toLowerCase();
          const departamento = fila.children[3].textContent.toLowerCase();
          const telefono = fila.children[4].textContent.toLowerCase();
          const correo = fila.children[5].textContent.toLowerCase();

          const coincideTexto =
            matricula.includes(texto) ||
            nombre.includes(texto) ||
            departamento.includes(texto) ||
            telefono.includes(texto) ||
            correo.includes(texto);

          const coincideDepartamento =
            departamentoSeleccionado === "" || departamento === departamentoSeleccionado;

          fila.style.display = (coincideTexto && coincideDepartamento) ? "" : "none";
        });
      }

      buscador.addEventListener("input", filtrarTabla);
      filtroDepartamento.addEventListener("change", filtrarTabla);
      });

    document.addEventListener("DOMContentLoaded", function () {
      const toggleBtn = document.getElementById("toggleMenu");
      const menu = document.getElementById("menuLateral");

      // Estado inicial: contraído
      menu.classList.add("collapsed");

      toggleBtn.addEventListener("click", function () {
        menu.classList.toggle("collapsed");
      });
    });
  </script>
</body>
</html>
