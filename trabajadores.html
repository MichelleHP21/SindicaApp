<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Trabajadores</title>

  <!-- Estilos -->
  <link rel="stylesheet" href="css/style.css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto:700&display=swap" rel="stylesheet"/>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"/>
  <!--sweetAlert-->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
  <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-custom">
        <div class="container-fluid align-items-center justify-content-between position-relative">
            <!-- Lado izquierdo: Logo + Título -->
            <div class="d-flex align-items-center">
                <a class="navbar-brand mb-0" href="inicio.html">
                    <img src="img/logosindicato.png" alt="Logo Sindicato" width="130" height="120">
                </a>
                <span class="navbar-title text-white ms-3">
                    RepSindical HGZ NO.2
                </span>
            </div>

            <!-- Lado derecho: Usuario -->
            <div class="d-flex align-items-center text-white">
                <div class="dropdown">
                    <button class="btn btn-link text-white text-decoration-none dropdown-toggle d-flex align-items-center" 
                            type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <span id="nombreUsuarioNavbar" class="me-2"></span>
                        <img src="img/perfil.jpg" alt="Perfil Admin" class="rounded-circle" width="50" height="50">
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#"><i class="bi bi-person-circle me-2"></i>Mi Perfil</a></li>
                        <li><a class="dropdown-item cerrar-sesion" href="#"><i class="bi bi-box-arrow-right me-2"></i>Cerrar Sesión</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

  <!-- Contenedor principal -->
  <div class="d-flex">
    <!-- Menú lateral fijo con íconos y texto desplegable -->
    <nav id="menuLateral" class="menu-lateral">
      <ul>
        <li>
          <button id="toggleMenu" class="menu-toggle">
            <i class="bi bi-list"></i>
            <h3 class="menu-text">Menú</h3>
          </button>
        </li>
        <li><a href="inicio.html"><i class="bi bi-house"></i><span class="menu-text">Inicio</span></a></li>
        <li><a href="trabajadores.html"><i class="bi bi-people"></i><span class="menu-text">Trabajadores</span></a></li>
        <li><a href="configuracion.html"><i class="bi bi-gear"></i><span class="menu-text">Configuración</span></a></li>
        <li><a href="formatos.html"><i class="bi bi-file-earmark-text"></i><span class="menu-text">Formatos</span></a></li>
        <li><a href="registrar.html"><i class="bi bi-person-add"></i><span class="menu-text">Registrar</span></a></li>
        <li><a href="#" class="cerrar-sesion"><i class="bi bi-box-arrow-right"></i><span class="menu-text">Cerrar sesión</span></a></li>
      </ul>
    </nav>

    <!-- Contenido principal -->
    <div class="contenido-principal flex-grow-1 p-4">
      <!-- Breadcrumb -->
      <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="inicio.html" class="text-decoration-none">
              <i class="bi bi-house me-1"></i>Inicio
            </a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">
            <i class="bi bi-people me-1"></i>Trabajadores
          </li>
        </ol>
      </nav>
        <!-- Encabezado con botón -->
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h2><i class="bi bi-people"></i> Trabajadores</h2>
          <a href="registrar.html" class="btn btn-success">
            <i class="bi bi-person-plus-fill me-1"></i> Agregar trabajador
          </a>
        </div>

        <div class="row mb-4 align-items-center">
          <!-- Buscador -->
          <div class="col-md-7 d-flex justify-content-end">
            <div class="input-group">
              <label class="input-group-text" for="buscador" style="height: 38px;"><i class="bi bi-search"></i> Buscar</label>
              <input type="text" id="buscador" class="form-control" placeholder="Buscar por nombre, matrícula, departamento o correo..." style="height: 38px;">
              <label class="input-group-text" type="button" id="limpiarBusqueda" title="Limpiar búsqueda" style="height: 38px;">
                <i class="bi bi-x-lg"></i>
              </label>
            </div>
          </div>

          <!-- Filtro por departamento -->
          <div class="col-md-5 d-flex justify-content-end">
            <div class="input-group">
              <label class="input-group-text" for="filtroDepartamento" style="height: 38px;"><i class="bi bi-funnel-fill"></i> Filtros</label>
              <select id="filtroDepartamento" class="form-select" style="height: 38px;">
                <option value="">Todos</option>
                <option value="Administración">Administración</option>
                <option value="Recursos Humanos">Recursos Humanos</option>
                <option value="Mantenimiento">Mantenimiento</option>
                <option value="Enfermería">Enfermería</option>
              </select>
            </div>
          </div>
        </div>
        <div class="table-responsive col-md-15">
            <table id="tablaTrabajadores" class="table table-striped">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Matrícula</th>
                  <th>Nombre</th>
                  <th>Teléfono</th>
                  <th>Correo</th>
                  <th>Categoría</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="tablaTrabajadoresBody">
                <!-- Aquí se insertan las filas con JavaScript -->
              </tbody>
            </table>
            
            <!-- Modal Editar Trabajador -->
            <div class="modal fade" id="editarModal" tabindex="-1" aria-labelledby="editarModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content">
                  <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="editarModalLabel">
                      <i class="bi bi-pencil-square me-2"></i>Editar Trabajador
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                  </div>
                  <div class="modal-body">
                    <form id="formularioEditar">
                      <div class="row">
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-card-text me-1"></i>Matrícula:</label>
                          <input type="text" class="form-control" id="editMatricula" readonly>
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-person me-1"></i>Nombre(s):</label>
                          <input type="text" class="form-control" id="editNombre" required>
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-card-heading me-1"></i>Apellido Paterno:</label>
                          <input type="text" class="form-control" id="editApellidoPaterno" required>
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-card-heading me-1"></i>Apellido Materno:</label>
                          <input type="text" class="form-control" id="editApellidoMaterno">
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-building me-1"></i>OOAD:</label>
                          <input type="text" class="form-control" id="editOoad" required>
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-person-badge me-1"></i>No. de Plaza:</label>
                          <input type="text" class="form-control" id="editNoPlaza">
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-briefcase me-1"></i>Categoría:</label>
                          <select id="editCategoria" class="form-select" required>
                            <option value="">Seleccione una categoría</option>
                            <option value="Enfermería">Enfermería</option>
                            <option value="Médicos">Médicos</option>
                            <option value="Farmaceuticos">Farmaceuticos</option>
                            <option value="Administrativo">Administrativo</option>
                            <option value="Trabajo Social">Trabajo Social</option>
                            <option value="Conservación">Conservación</option>
                            <option value="Lavanderia">Lavanderia</option>
                            <option value="Laboratoristas">Laboratoristas</option>
                            <option value="Asistente Médico">Asistente Médico</option>
                            <option value="Operador de Ambuláncia">Operador de Ambuláncia</option>
                            <option value="Servicios de Nutrición y Dietetica">Servicios de Nutrición y Dietetica</option>
                            <option value="Técnico Radiólogo">Técnico Radiólogo</option>
                            <option value="Limpieza e Higiene">Limpieza e Higiene</option>
                            <option value="Camilleros">Camilleros</option>
                            <option value="Almacén">Almacén</option>
                            <option value="Soporte Técnico en Informática">Soporte Técnico en Informática</option>
                            <option value="Quirofano">Quirofano</option>
                            <option value="Nutrición y dietetica">Nutrición y dietetica</option>
                            <option value="Sector Estadística">Sector Estadística</option>
                            <option value="Laboratorio">Laboratorio</option>
                            <option value="Representación Sindical">Representación Sindical</option>
                            <option value="ARIMAC">ARIMAC</option>
                          </select>
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-calendar-check me-1"></i>Tipo de Contratación:</label>
                          <select id="editContratacion" class="form-select" required>
                            <option value="">Seleccione...</option>
                            <option value="Confianza">Confianza</option>
                            <option value="Base">Base</option>
                            <option value="Becado">Becado</option>
                          </select>
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-clock me-1"></i>Turno:</label>
                          <select id="editTurno" class="form-select" required>
                            <option value="">Seleccione...</option>
                            <option value="Matutino">Matutino</option>
                            <option value="Vespertino">Vespertino</option>
                            <option value="Nocturno">Nocturno</option>
                            <option value="Mixto">Mixto</option>
                            <option value="Administrativo">Administrativo</option>
                          </select>
                        </div>
                        <div class="col-md-3 form-group">
                          <label><i class="bi bi-clock-history me-1"></i>Hora Inicio:</label>
                          <input type="time" class="form-control" id="editHoraInicio">
                        </div>
                        <div class="col-md-3 form-group">
                          <label><i class="bi bi-clock me-1"></i>Hora Fin:</label>
                          <input type="time" class="form-control" id="editHoraFin">
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-envelope me-1"></i>Correo Electrónico:</label>
                          <input type="email" class="form-control" id="editCorreo" required>
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-calendar me-1"></i>Día de Descanso:</label>
                          <input type="text" class="form-control" id="editDiaDescanso">
                        </div>
                        <div class="col-md-12 form-group">
                          <label><i class="bi bi-geo-alt me-1"></i>Dirección:</label>
                          <input type="text" class="form-control" id="editDireccion">
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-telephone me-1"></i>Teléfono:</label>
                          <input type="tel" class="form-control" id="editTelefono" required>
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-person-vcard me-1"></i>CURP:</label>
                          <input type="text" class="form-control" id="editCurp">
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-person-vcard-fill me-1"></i>RFC:</label>
                          <input type="text" class="form-control" id="editRfc">
                        </div>
                        <div class="col-md-6 form-group">
                          <label><i class="bi bi-calendar-date me-1"></i>Fecha de Nacimiento:</label>
                          <input type="date" class="form-control" id="editFechaNac">
                        </div>
                      </div>
                    </form>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                      <i class="bi bi-x-circle me-1"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" id="btnGuardarEdicion">
                      <i class="bi bi-save me-1"></i>Guardar Cambios
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Modal Ver Trabajador -->
            <div class="modal fade" id="verModal" tabindex="-1" aria-labelledby="verModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content">
                  <div class="modal-header text-white">
                    <h5 class="modal-title" id="verModalLabel">
                      <i class="bi bi-eye-fill me-2"></i>Información del Trabajador
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                  </div>
                  <div class="modal-body">
                    <div class="row">
                      <div class="col-md-4 text-center mb-4">
                        <div class="bg-light rounded p-3">
                          <i class="bi bi-person-circle display-1 text-success"></i>
                          <h6 class="mt-2 mb-0" id="verNombreDisplay"></h6>
                          <small class="text-muted" id="verMatriculaDisplay"></small>
                        </div>
                      </div>
                      <div class="col-md-8">
                        <div class="row">
                          <div class="col-12 mb-3">
                            <label class="form-label fw-bold">
                              <i class="bi bi-card-text me-1"></i>Matrícula
                            </label>
                            <div class="form-control-plaintext border rounded p-2 bg-light" id="verMatricula"></div>
                          </div>
                          <div class="col-12 mb-3">
                            <label class="form-label fw-bold">
                              <i class="bi bi-person me-1"></i>Nombre Completo
                            </label>
                            <div class="form-control-plaintext border rounded p-2 bg-light" id="verNombre"></div>
                          </div>
                          <div class="col-12 mb-3">
                            <label class="form-label fw-bold">
                              <i class="bi bi-building me-1"></i>Departamento
                            </label>
                            <div class="form-control-plaintext border rounded p-2 bg-light" id="verDepartamento"></div>
                          </div>
                          <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold">
                              <i class="bi bi-telephone me-1"></i>Teléfono
                            </label>
                            <div class="form-control-plaintext border rounded p-2 bg-light" id="verTelefono"></div>
                          </div>
                          <div class="col-md-6 mb-3">
                            <label class="form-label fw-bold">
                              <i class="bi bi-shield-check me-1"></i>Estado
                            </label>
                            <div class="form-control-plaintext border rounded p-2 bg-light">
                              <span class="badge bg-success badge-custom">
                                <i class="bi bi-check-circle me-1"></i>Activo
                              </span>
                            </div>
                          </div>
                          <div class="col-12 mb-3">
                            <label class="form-label fw-bold">
                              <i class="bi bi-envelope me-1"></i>Correo Electrónico
                            </label>
                            <div class="form-control-plaintext border rounded p-2 bg-light" id="verCorreo"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                      <i class="bi bi-x-circle me-1"></i>Cerrar
                    </button>
                    <button type="button" class="btn btn-primary" onclick="editarDesdeVer()">
                      <i class="bi bi-pencil-square me-1"></i>Editar Información
                    </button>
                  </div>
                </div>
              </div>
            </div>
        </div>
    </div> <!-- Fin contenido principal -->
  </div> <!-- Fin contenedor principal -->
  
  <!-- Bootstrap JS (necesario para que los modales funcionen) -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const usuarioStr = localStorage.getItem("usuario");
      const usuario = usuarioStr ? JSON.parse(usuarioStr) : null;

      if (!usuario || usuario.Rol !== "administrador") {
        window.location.href = "index.html";
      }
    });
  </script> 
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="java/trabajadores.js?v=2.0"></script>
  <script src="java/sesion.js"></script>
  <script src="java/menu.js"></script>
  <script src="java/cerrarsesion.js"></script>
</body>
</html>